<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="format-detection" content="telephone=no">
    <meta name="format-detection" content="email=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="full-screen" content="yes">
    <meta name="browsermode" content="application">
    <meta name="x5-orientation" content="landscape">
    <meta name="x5-fullscreen" content="true">
    <meta name="x5-page-mode" content="app">
    <meta name="keywords" content="fc,在线fc游戏,fc在线模拟器,nes在线模拟器,魂斗罗,超级玛丽,忍者龙剑传," />
    <meta name="description" content="任天堂FC/NES原版ROM在线玩，可以近乎完美的还原fc卡带游戏的视频和声音。" />
    <link rel="shortcut icon" href="favicon.ico">
    <link href="./css/style.css" rel="stylesheet" type="text/css" />
    <title>任天堂FC/NES原版ROM在线玩</title>
</head>


<body>
    <div class="main">
        <div class="panel">
            <div class="controller-area">
                <div class="controller">
                    <div id="controls-direction">
                        <div id="controls-rocker"></div>
                        <button role="BUTTON_UP" class="up joydirection" id="joystick_btn_up">up</button>
                        <button role="BUTTON_RIGHT" class="right joydirection" id="joystick_btn_right">right</button>
                        <button role="BUTTON_DOWN" class="down joydirection" id="joystick_btn_down">down</button>
                        <button role="BUTTON_LEFT" class="left joydirection" id="joystick_btn_left">left</button>
                    </div>
                </div>
                <div class="joy">I</div>
                <div><a href="#" class="readme">Description</a></div>
            </div>
            <div class="function-area">
                <div class="screen">
                    <div id="emulator"></div>
                </div>
                <div class="function">
                    <button class="controls-center-select joybtn" id="joystick_btn_select"
                        role="BUTTON_SELECT">Select</button>
                    <button class="controls-center-start joybtn" id="joystick_btn_start"
                        role="BUTTON_START">Pause</button>
                </div>
            </div>
            <div class="action-area">
                <div class="action">
                    <div id="controls-fire">
                        <button class="a joybtn" role="BUTTON_A" id="joystick_btn_A">A</button>
                        <button class="b joybtn" role="BUTTON_B" id="joystick_btn_B">B</button>
                    </div>
                </div>
            </div>
            <div class="sign">FAMILY <br> COMPUTER</div>
        </div>
    </div>

    <div id="description" class="hidden">
        <table>
            <tbody>
                <tr>
                    <td>按键</td>
                    <td>player1</td>
                    <td>player2</td>
                </tr>
                <tr>
                    <td>Left</td>
                    <td>A</td>
                    <td>Num(4)</td>
                </tr>
                <tr>
                    <td>Right</td>
                    <td>D</td>
                    <td>Num(6)</td>
                </tr>
                <tr>
                    <td>Up</td>
                    <td>W</td>
                    <td>Num(8)</td>
                </tr>
                <tr>
                    <td>Down</td>
                    <td>S</td>
                    <td>Num(2)</td>
                </tr>
                <tr>
                    <td>A</td>
                    <td>J</td>
                    <td>Num(7)</td>
                </tr>
                <tr>
                    <td>B</td>
                    <td>K</td>
                    <td>Num(9)</td>
                </tr>
                <tr>
                    <td>AA</td>
                    <td>Z</td>
                    <td>Num(/)</td>
                </tr>
                <tr>
                    <td>BB</td>
                    <td>X</td>
                    <td>Num(*)</td>
                </tr>
                <tr>
                    <td>Start</td>
                    <td>Enter</td>
                    <td>Num(1)</td>
                </tr>
                <tr>
                    <td>Select</td>
                    <td>Space</td>
                    <td>Num(3)</td>
                </tr>
            </tbody>
        </table>
    </div>


    <script src="./js/jquery-1.4.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/dynamicaudio-min.js" type="text/javascript" charset="utf-8"></script>
    <!--<script src="./lib/debug.mini.js" type="text/javascript" charset="utf-8"></script>-->
    <script src="./js/nipplejs.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/joystick.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/nes.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/utils.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/cpu.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/keyboard.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/mappers.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/papu.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/ppu.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/rom.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/ui.js" type="text/javascript" charset="utf-8"></script>

    <script type="text/javascript" charset="utf-8">
        $(function () {
            try {
                fetch('./roms/roms.json')
                    .then(response => response.json())
                    .then(data => {
                        console.log(data);
                        var nes = new JSNES({ 'ui': $('#emulator').JSNESUI(data) });
                    });
            } catch (error) {
                console.err(error);
            }
        });
    </script>

    <!--[if IE]>
    <script type="text/vbscript" src="jsnes-ie-hacks.vbscript"></script>
    <![endif]-->

    <script>

        const readmeBtn = document.querySelector('.readme');
        const descriptionDIv = document.querySelector('#description');
        readmeBtn.addEventListener('click', () => {
            descriptionDIv.classList.toggle('hidden');
        })

        function touchDwon(evt) {
            nes.keyboard.keyDown({
                keyCode: evt.keyCode
            });
        };

        function touchUp(evt) {
            nes.keyboard.keyUp({
                keyCode: evt.keyCode
            });
        };

        function select(val) {
            if (val.substring(0, 1) == "#") {
                return document.querySelector(val);
            } else {
                return document.getElementById(val);
            }
        }

        var joystick = new Joystick({
            el: select("controls-rocker"),
            mode: 'static',
            color: "#808080",
            size: 150,
            isFourBtn: false,
            keyCodes: [87, 83, 65, 68], // W S A D 
            btn_down_fn: touchDwon,
            btn_up_fn: touchUp,
            relative: true,
        });
        joystick.init();

    </script>

</body>

</html>

<!-- /**
 * fc在线玩
 * Gitee 开源地址：https://gitee.com/feiyu22/jsnes
 * 转载或使用时，还请保留以上信息，谢谢！
 */ -->
